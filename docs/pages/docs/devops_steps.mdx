import { Steps } from 'nextra/components'

## DevOps steps

- Each organization, organizational unit, library, application, tool, middleware, microservice, data pipeline, dashboard, etc. is a component. We need code repository, CI/CD pipeline, artifact repositories and other DevOps infrastructure resources for each component.

- Infrastructure as code components.
  - Terraform.
  - Ansible.
  - REST API ( Use mastercard terraform rest api provider )
  - Jenkins Configuration as Code (a.k.a. JCasC) Plugin.

<Steps>

### Google account
- Create account in google with examplebank2024@gmail.com email address.

### Github account for code repository component
- Create account in Github with email address examplebank2024@gmail.com and username examplebank2024.

### Atlassian account for project management, ITSM and component catalog components
- Create account in Atlassian with email address examplebank2024@gmail.com and subscribe to Jira (for project management), Jira Service Management (for ITSM) and Compass (for component catalog) products.

### Github organization
- Create organization in Github with name examplebank.

### AWS organization management account
- Create AWS account with root user email address examplebank2024@gmail.com and AWS account name examplebank.
- Add MFA to root user.
- Create AWS IAM user with name administrator and permissions AdministratorAccess.
- Add MFA to administrator user.

### Code repository template
- Create Github repository template with following features.
  - devops, docs and tests directories. ( No need for .github/workflows/docs since docs will be deployed by the CI/CD pipeline in different environments ).
  - release/1.0 branch.
  - devops/configuration folder will have configuration files for component, integrated, e2e, performance, production and dr environments.

### Organization code repository
- Create Github repository examplebank in examplebank organization from the Github repository template.
- Create terraform module in devops/infrastructure folder to 
  - create AWS organization with name examplebank.
  - enable AWS identity center.
- Create unit tests in tests/unit folder for the terraform module.
- Create temporary shell script in devops/cicd_pipeline folder to 
  - install terraform and terratest.
  - run the unit tests.
  - run the terraform module.
  - update devops/configuration files
- AWS control tower adds a lot of infrastructure whose code is not stored in terraform so we are not using AWS control tower.
- Temporary shell script will be replaced by Jenkins CI/CD pipeline when Jenkins component is installed in devops organizational unit.

### devops organizational unit code repository
- Create Github repository devops in examplebank organization from the Github repository template.
- Create terraform module in devops/infrastructure folder to 
  - create AWS organizational unit with name devops in AWS organization examplebank.
  - create AWS organization accounts for component, integrated, e2e, performance, production and dr environments of devops organizational unit.
  - service control policies and iam identity center.
  - install infrastructure like aws eks which is common for all components deployed to the devops organizational unit.
- Create unit tests in tests/unit folder for the terraform module.
- Create temporary shell script in devops/cicd_pipeline folder to 
  - install terraform and terratest.
  - run the unit tests.
  - run the terraform module.
  - update devops/configuration files
- AWS control tower adds a lot of infrastructure whose code is not stored in terraform so we are not using AWS control tower.
- Temporary shell script will be replaced by Jenkins CI/CD pipeline when Jenkins component is installed in devops organizational unit.

### Configuration
- Configuration should be stored in devops/configuration of examplebank organization, devops organizational unit, jenkins and other components.
- CI/CD pipeline should package these and push to artifact repository
- CI/CD pipeline should deploy these configurations to configuration management component like Hashicorp Consul during the deployment to respective environment.
- When the application starts, it should download this configuration according to authentication and authorization setup by CI/CD pipeline and merge the configuration with component configuration overwriting the organizational unit configuration which overwrites the organization configuration. 
- Yaml files should be used to store the configuration due to requirements for dictionary and array data structures.

### Secrets
- Components should use keystore and truststore for inter communication authentication and authorization.
- For each environment, they should get their keystore and truststore from secret management component like Hashicorp Vault according to authentication and authorization setup by CI/CD pipeline and use their CA certificate key from keystore and trusted CA certificate keys from truststore to communicate with other components.
- secret management component like Hashicorp Vault is responsible for rotating the CA certificate key.
- Middleware like databases are also components.
- Passwords should only be used if keys are not supported. This is because with keys, you have 2 way authentication and authorization. Server checks if client CA certificate key is in its truststore and client checks if server CA certificate key key is in its truststore. CA certificate keys are rotated from the same CA. CA certificate keys are long and difficult to brute force. Internally the mechanism uses short lived session tokens after initial handshake with the CA certificate keys.
- security organizational unit is responsible for secret management components like Hashicorp Vault.

### Code repository component code repository
- create devops-github component code repository

### CI/CD pipeline component code repository
- create devops-jenkins component code repository

### component catalog component code repository
- create devops-compass component code repository

### artifact repository component code repository
- create devops-nexusrm component code repository

### Rancher desktop
- Install rancher desktop on laptop with containerd container enginer instead of docker container engine.
- https://rancherdesktop.io/

### Identify code repository application
- github

### Identify CI/CD pipeline application
- jenkins

### CI/CD pipeline application infrastructure component
- Code repository
  - Create devops-jenkins-infrastructure code repository
  - This will use shell script or github actions to create Jenkins executables, archives, installers, container images, helm charts and virtual machine images for different operating systems and middlewares. It will install required plugins like configuration as code plugin as part of the image.
  - This will use shell script or github actions to create Jenkins infrastructure and configure it using configuration as code
- CI/CD pipeline
  - It will also create devops-jenkins-infrastructure CI/CD pipeline

### Code repository application infrastructure component
- Code repository
  - Create devops-github-infrastructure code repository
- CI/CD pipeline
  - Update devops-jenkins-infrastructure code repository to create devops-github-infrastructure CI/CD pipeline

### Identify ITSM with ITAM/CMDB/Component catalog application
- Jira service management (jsm) with Atlassian compass (component catalog)
- ITSM is has all features of helpdesk and servicedesk and more features so organizational unit for the application is itsm.
  - https://www.atlassian.com/itsm/service-request-management/help-desk-vs-service-desk-vs-itsm
- Atlassian compass
  - https://developer.atlassian.com/cloud/compass/overview/what-is-compass/
- Affected services in Jira service management are synced with Atlassian compass components
  - https://support.atlassian.com/jira-service-management-cloud/docs/synchronize-your-services-with-compass/

### ITAM/CMDB/Component catalog application infrastructure component
- Code repository
  - Update devops-github-infrastructure code repository to create itsm-compass-infrastructure code repository
- CI/CD pipeline
  - Update devops-jenkins-infrastructure code repository to create itsm-compass-infrastructure CI/CD pipeline
- add custom fields like organizational unit and application to compass settings -> custom fields.

### Components code repository and CI/CD pipeline
- For each component added to Atlassian compass, devops-github-infrastructure and devops-jenkins-infrastructure CI/CD pipelines should create corresponding code repository and CI/CD pipeline.
- Events or webhooks

</Steps>
